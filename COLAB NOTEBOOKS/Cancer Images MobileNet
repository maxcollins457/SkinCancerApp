{"cells":[{"cell_type":"markdown","metadata":{"id":"zYfe4W0-jwJ2"},"source":["## Importing necessary libraies"]},{"cell_type":"code","execution_count":1,"metadata":{"id":"H-qGqotGMTnu","executionInfo":{"status":"ok","timestamp":1700838366382,"user_tz":0,"elapsed":10674,"user":{"displayName":"Max C","userId":"15129973457982956339"}}},"outputs":[],"source":["import numpy as np\n","import pandas as pd\n","import os\n","from glob import glob\n","import matplotlib.pyplot as plt\n","\n","\n","import tensorflow as tf\n","from keras.models import Sequential\n","from keras.layers import Dense, Conv2D, MaxPool2D , Flatten, Dropout, GlobalAveragePooling2D\n","from keras.optimizers import Adam\n","from keras.callbacks import ReduceLROnPlateau\n","from keras.preprocessing.image import ImageDataGenerator\n","from sklearn.metrics import  ConfusionMatrixDisplay\n","from keras.utils import plot_model"]},{"cell_type":"markdown","metadata":{"id":"iF-aaIa9j5af"},"source":["## EDA and Data Preprocessing\n","\n","Before we can begin training/testing the model, EDA is required to assess what preprocessing will be needed."]},{"cell_type":"code","execution_count":2,"metadata":{"executionInfo":{"elapsed":29130,"status":"ok","timestamp":1700838395509,"user":{"displayName":"Max C","userId":"15129973457982956339"},"user_tz":0},"id":"8D_WOs06M6V-"},"outputs":[],"source":["meta_data = pd.read_csv(\"/content/drive/My Drive/CancerImages/HAM10000_metadata.csv\")\n","\n","lesion_type_dict = {\n","    'nv': 'Melanocytic nevi',\n","    'mel': 'Melanoma',\n","    'bkl': 'Benign keratosis-like lesions ',\n","    'bcc': 'Basal cell carcinoma',\n","    'akiec': 'Actinic keratoses',\n","    'vasc': 'Vascular lesions',\n","    'df': 'Dermatofibroma'\n","}\n","\n","# Check the class names and their corresponding indices\n","class_names = list(lesion_type_dict.values())\n","# Get the class index mapping\n","class_index_mapping = {class_name: idx for idx, class_name in enumerate(class_names)}\n","\n","is_cancerous = {\n","    'nv': 0,\n","    'mel': 1,\n","    'bkl': 0,\n","    'bcc': 1,\n","    'akiec': 0,\n","    'vasc': 0,\n","    'df': 0\n","}\n","\n","base_skin_dir = '/content/drive/My Drive/CancerImages'\n","\n","imageid_path_dict = {os.path.splitext(os.path.basename(x))[0]: x\n","                     for x in glob(os.path.join(base_skin_dir, '*', '*.jpg'))}\n","\n","\n","# Add path to image to meta_data\n","meta_data['path'] = meta_data['image_id'].map(imageid_path_dict.get)\n","# Add lesion type to image to meta_data\n","meta_data['cell_type'] = meta_data['dx'].map(lesion_type_dict.get)\n","# Convert this to categorical\n","meta_data['cell_type_idx'] = pd.Categorical(meta_data['cell_type']).codes\n","\n","# Fill empty ages with mean\n","meta_data['age'].fillna((meta_data['age'].mean()), inplace=True)"]},{"cell_type":"code","execution_count":3,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":246,"status":"ok","timestamp":1700838395752,"user":{"displayName":"Max C","userId":"15129973457982956339"},"user_tz":0},"id":"rBrOmuQ9XBM7","outputId":"d420b053-1dc3-4be0-c775-f346d63acec0"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["{2: 0.467697907188353,\n"," 0: 0.07665920954511558,\n"," 6: 4.469565217391304,\n"," 1: 0.4618149146451033,\n"," 5: 3.619718309859155,\n"," 3: 1.0,\n"," 4: 1.5718654434250765}"]},"metadata":{},"execution_count":3}],"source":["labels = list(meta_data['cell_type'].unique())\n","ids = [class_index_mapping.get(label) for label in labels]\n","\n","def estimate_weights_mfb(label):\n","    class_weights = np.zeros_like(label, dtype=float)\n","    counts = np.zeros_like(label)\n","    for i,l in enumerate(label):\n","        counts[i] = meta_data[meta_data['cell_type']==str(l)]['cell_type'].value_counts()[0]\n","    counts = counts.astype(float)\n","    median_freq = np.median(counts)\n","    for i, label in enumerate(label):\n","        class_weights[i] = median_freq / counts[i]\n","    return class_weights\n","\n","classweights = estimate_weights_mfb(labels)\n","\n","classweight_dict = {label: weight for label, weight in zip(ids, classweights)}\n","\n","meta_data['class_weight'] = meta_data['cell_type'].map(classweight_dict.get)\n","\n","\n","classweight_dict"]},{"cell_type":"code","source":["code_to_name = {code:name for code, name in zip(ids,labels)}\n","code_to_name"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"q8jCDK6PIqMI","executionInfo":{"status":"ok","timestamp":1700838395752,"user_tz":0,"elapsed":4,"user":{"displayName":"Max C","userId":"15129973457982956339"}},"outputId":"34fd3074-69c0-4cea-f3f3-5938ffbcfd8c"},"execution_count":4,"outputs":[{"output_type":"execute_result","data":{"text/plain":["{2: 'Benign keratosis-like lesions ',\n"," 0: 'Melanocytic nevi',\n"," 6: 'Dermatofibroma',\n"," 1: 'Melanoma',\n"," 5: 'Vascular lesions',\n"," 3: 'Basal cell carcinoma',\n"," 4: 'Actinic keratoses'}"]},"metadata":{},"execution_count":4}]},{"cell_type":"markdown","metadata":{"id":"ePFlhDafbaHn"},"source":["## Setup for ML\n","Need to to add images to the dataset.\n","\n","Then need to split into train/validation/test sets.\n"]},{"cell_type":"code","execution_count":5,"metadata":{"id":"3iIqHI56aNbm","executionInfo":{"status":"ok","timestamp":1700838395752,"user_tz":0,"elapsed":2,"user":{"displayName":"Max C","userId":"15129973457982956339"}}},"outputs":[],"source":["df = meta_data.copy(deep=True)"]},{"cell_type":"code","execution_count":6,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":36330,"status":"ok","timestamp":1700838432080,"user":{"displayName":"Max C","userId":"15129973457982956339"},"user_tz":0},"id":"VABo9kXMEvh_","outputId":"9aa171fc-35c3-4dc6-aec6-b651e8fddae4"},"outputs":[{"output_type":"stream","name":"stdout","text":["Found 10015 files belonging to 7 classes.\n","Using 8012 files for training.\n","Found 10015 files belonging to 7 classes.\n","Using 2003 files for validation.\n"]}],"source":["img_size = (75, 100)\n","\n","# Set up the training dataset with a validation split\n","train_dataset = tf.keras.utils.image_dataset_from_directory(\n","    directory='/content/drive/My Drive/CancerImages/Images/',\n","    label_mode='categorical',\n","    class_names=list(lesion_type_dict.values()),\n","    image_size=img_size,\n","    seed=1234,\n","    validation_split=0.2,\n","    subset='training'\n",")\n","\n","# Set up the training dataset with a validation split\n","validation_dataset = tf.keras.utils.image_dataset_from_directory(\n","    directory='/content/drive/My Drive/CancerImages/Images/',\n","    label_mode='categorical',\n","    class_names=list(lesion_type_dict.values()),\n","    image_size=img_size,\n","    seed=1234,\n","    validation_split=0.2,\n","    subset='validation'\n",")\n","\n","val_batches = tf.data.experimental.cardinality(validation_dataset)\n","test_dataset = validation_dataset.take(val_batches // 5)\n","validation_dataset = validation_dataset.skip(val_batches // 5)"]},{"cell_type":"code","execution_count":7,"metadata":{"id":"lT0fIefwHpOU","executionInfo":{"status":"ok","timestamp":1700838432081,"user_tz":0,"elapsed":5,"user":{"displayName":"Max C","userId":"15129973457982956339"}}},"outputs":[],"source":["AUTOTUNE = tf.data.AUTOTUNE\n","\n","train_dataset = train_dataset.prefetch(buffer_size=AUTOTUNE)\n","validation_dataset = validation_dataset.prefetch(buffer_size=AUTOTUNE)\n","test_dataset = test_dataset.prefetch(buffer_size=AUTOTUNE)"]},{"cell_type":"code","execution_count":13,"metadata":{"id":"bxY_ElR3HqKQ","executionInfo":{"status":"ok","timestamp":1700838630814,"user_tz":0,"elapsed":3170,"user":{"displayName":"Max C","userId":"15129973457982956339"}}},"outputs":[],"source":["from tensorflow.keras.models import Sequential, Model, load_model\n","model = load_model('/content/drive/My Drive/CancerImages/Models/model.h5')"]},{"cell_type":"markdown","metadata":{"id":"R_ig0ifwkPIA"},"source":["## Model Setup\n","\n","Now the data has been appropriately preprocessed, the model must be set up so it can be trained on the data."]},{"cell_type":"code","execution_count":null,"metadata":{"executionInfo":{"elapsed":5,"status":"aborted","timestamp":1700838432432,"user":{"displayName":"Max C","userId":"15129973457982956339"},"user_tz":0},"id":"LGYkOV_v_2vi"},"outputs":[],"source":["input_shape = img_size + (3,)\n","n_classes = len(list(lesion_type_dict.values()))\n","\n","#Randomly flip, rotate and zoom the data\n","data_augmentation = tf.keras.Sequential([\n","  tf.keras.layers.RandomFlip('horizontal'),\n","  tf.keras.layers.RandomRotation(0.2),\n","  tf.keras.layers.RandomZoom(.5, .2)\n","])\n","\n","#Rescale input to be [-1, 1] not [0, 255]\n","preprocess_input = tf.keras.applications.mobilenet_v2.preprocess_input\n","\n","# Define structure of base model\n","base_model = tf.keras.applications.MobileNetV2(input_shape=input_shape,\n","                                               include_top=False,\n","                                               weights='imagenet')\n","\n","#Freeze the weights of base model\n","base_model.trainable = False\n","\n","\n","#Add a prediction layer\n","global_average_layer = GlobalAveragePooling2D()\n","prediction_layer  = Dense(n_classes, activation='softmax')\n","\n","\n","#Combine preprocessing and model\n","inputs = tf.keras.Input(shape=input_shape)\n","x = data_augmentation(inputs)\n","x = preprocess_input(x)\n","x = base_model(x, training=False)\n","x = global_average_layer(x)\n","x = Dropout(0.2)(x)\n","outputs = prediction_layer(x)\n","model = tf.keras.Model(inputs, outputs)\n","model.summary()\n","\n","# Define the optimizer\n","base_learning_rate = 0.0001\n","optimizer = Adam(learning_rate= base_learning_rate)\n","\n","# Compile the model\n","\n","model.compile(optimizer = optimizer , loss = \"categorical_crossentropy\", metrics=[\"accuracy\"])"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"sti3djnjc_1N","executionInfo":{"status":"aborted","timestamp":1700838432432,"user_tz":0,"elapsed":5,"user":{"displayName":"Max C","userId":"15129973457982956339"}}},"outputs":[],"source":["initial_epochs = 5\n","\n","history = model.fit(train_dataset,\n","                    epochs=initial_epochs,\n","                    validation_data=validation_dataset,\n","                    class_weight = classweight_dict)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"XKS04cuddFTJ","executionInfo":{"status":"aborted","timestamp":1700838432433,"user_tz":0,"elapsed":6,"user":{"displayName":"Max C","userId":"15129973457982956339"}}},"outputs":[],"source":["acc = history.history['accuracy']\n","val_acc = history.history['val_accuracy']\n","\n","plt.figure(figsize=(8, 8))\n","plt.subplot(2, 1, 1)\n","plt.plot(acc, label='Training Accuracy')\n","plt.plot(val_acc, label='Validation Accuracy')\n","plt.legend(loc='lower right')\n","plt.ylabel('Accuracy')\n","plt.title('Training and Validation Accuracy')"]},{"cell_type":"code","source":["# model.save(base_skin_dir + 'WeightedClass.keras')"],"metadata":{"id":"jF7xVT0xhIgB","executionInfo":{"status":"aborted","timestamp":1700838432433,"user_tz":0,"elapsed":6,"user":{"displayName":"Max C","userId":"15129973457982956339"}}},"execution_count":null,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"8utUkk9NdUOF"},"source":["## Model Performance"]},{"cell_type":"code","execution_count":14,"metadata":{"id":"byZnJd7qdZiC","colab":{"base_uri":"https://localhost:8080/","height":663},"executionInfo":{"status":"ok","timestamp":1700838708139,"user_tz":0,"elapsed":70299,"user":{"displayName":"Max C","userId":"15129973457982956339"}},"outputId":"896dc544-7c62-4450-9a2f-cd93387e6a7f"},"outputs":[{"output_type":"stream","name":"stdout","text":["1/1 [==============================] - 1s 531ms/step\n","1/1 [==============================] - 0s 290ms/step\n","1/1 [==============================] - 0s 288ms/step\n","1/1 [==============================] - 1s 1s/step\n","1/1 [==============================] - 1s 1s/step\n","1/1 [==============================] - 1s 643ms/step\n","1/1 [==============================] - 0s 260ms/step\n","1/1 [==============================] - 0s 259ms/step\n","1/1 [==============================] - 0s 499ms/step\n","1/1 [==============================] - 0s 263ms/step\n","1/1 [==============================] - 0s 270ms/step\n","1/1 [==============================] - 0s 286ms/step\n"]},{"output_type":"display_data","data":{"text/plain":["<Figure size 640x480 with 2 Axes>"],"image/png":"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\n"},"metadata":{}}],"source":["y_pred = []  # store predicted labels\n","y_true = []  # store true labels\n","\n","# iterate over the dataset\n","for image_batch, label_batch in test_dataset:   # use dataset.unbatch() with repeat\n","   # append true labels\n","   y_true.append(label_batch)\n","   # compute predictions\n","   preds = model.predict(image_batch)\n","   # append predicted labels\n","   y_pred.append(np.argmax(preds, axis = - 1))\n","\n","# # convert the true and predicted labels into tensors\n","correct_labels = tf.concat([np.argmax(item, axis=1) for item in y_true], axis = 0)\n","predicted_labels = tf.concat([item for item in y_pred], axis = 0)\n","\n","\n","# Display the confusion matrix with rotated x-axis labels\n","ConfusionMatrixDisplay.from_predictions(y_test, Y_pred_classes,display_labels=list(code_to_name.values()), cmap='inferno', normalize='true', values_format=\".0%\")\n","plt.xticks(rotation=90)\n","plt.grid(False)\n","plt.show()\n","\n","code_to_name = {code:name for code, name in zip(ids,labels)}"]},{"cell_type":"code","source":["base_model.trainable = True\n","\n","# Let's take a look to see how many layers are in the base model\n","print(\"Number of layers in the base model: \", len(base_model.layers))\n","\n","# Fine-tune from this layer onwards\n","fine_tune_at = 110\n","\n","# Freeze all the layers before the `fine_tune_at` layer\n","for layer in base_model.layers[:fine_tune_at]:\n","  layer.trainable = False\n","\n","\n","optimizer = Adam(learning_rate= base_learning_rate/10)\n","\n","# Compile the model\n","\n","model.compile(optimizer = optimizer , loss = \"categorical_crossentropy\", metrics=[\"accuracy\"])\n","\n","\n","fine_tune_epochs = 5\n","total_epochs =  initial_epochs + fine_tune_epochs\n","\n","history_fine = model.fit(train_dataset,\n","                         epochs=total_epochs,\n","                         initial_epoch=history.epoch[-1],\n","                         validation_data=validation_dataset,\n","                    class_weight = classweight_dict)\n"],"metadata":{"id":"rshBZ5Qbl3QX","executionInfo":{"status":"aborted","timestamp":1700838432433,"user_tz":0,"elapsed":5,"user":{"displayName":"Max C","userId":"15129973457982956339"}}},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["acc += history_fine.history['accuracy']\n","val_acc += history_fine.history['val_accuracy']\n","\n","plt.figure(figsize=(8, 8))\n","plt.subplot(2, 1, 1)\n","plt.plot(acc, label='Training Accuracy')\n","plt.plot(val_acc, label='Validation Accuracy')\n","plt.plot([initial_epochs-1,initial_epochs-1],\n","          plt.ylim(), label='Start Fine Tuning')\n","plt.legend(loc='lower right')\n","plt.title('Training and Validation Accuracy')"],"metadata":{"id":"LyCHFjVbrzYC","executionInfo":{"status":"aborted","timestamp":1700838432433,"user_tz":0,"elapsed":5,"user":{"displayName":"Max C","userId":"15129973457982956339"}}},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["y_pred = []  # store predicted labels\n","y_true = []  # store true labels\n","\n","# iterate over the dataset\n","for image_batch, label_batch in test_dataset:   # use dataset.unbatch() with repeat\n","   # append true labels\n","   y_true.append(label_batch)\n","   # compute predictions\n","   preds = model.predict(image_batch)\n","   # append predicted labels\n","   y_pred.append(np.argmax(preds, axis = - 1))\n","\n","# # convert the true and predicted labels into tensors\n","correct_labels = tf.concat([np.argmax(item, axis=1) for item in y_true], axis = 0)\n","predicted_labels = tf.concat([item for item in y_pred], axis = 0)\n","\n","\n","ConfusionMatrixDisplay.from_predictions(correct_labels, predicted_labels, normalize='true', cmap = 'inferno')\n","plt.grid(False)\n","plt.show()"],"metadata":{"id":"t3sehcU-mCum","executionInfo":{"status":"aborted","timestamp":1700838432433,"user_tz":0,"elapsed":5,"user":{"displayName":"Max C","userId":"15129973457982956339"}}},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["model.save('FineTuneWeightedClassMobileNet.keras')"],"metadata":{"id":"5bFNIk7S4MFG","executionInfo":{"status":"aborted","timestamp":1700838432433,"user_tz":0,"elapsed":5,"user":{"displayName":"Max C","userId":"15129973457982956339"}}},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["base_model.trainable = True\n","# Fine-tune from this layer onwards\n","fine_tune_at = 100\n","\n","# Freeze all the layers before the `fine_tune_at` layer\n","for layer in base_model.layers[:fine_tune_at]:\n","  layer.trainable = False\n","\n","\n","optimizer = Adam(learning_rate= base_learning_rate/15)\n","\n","# Compile the model\n","\n","model.compile(optimizer = optimizer , loss = \"categorical_crossentropy\", metrics=[\"accuracy\"])\n","\n","\n","double_fine_tune_epochs = 5\n","total_epochs =  initial_epochs + fine_tune_epochs + double_fine_tune_epochs\n","\n","history_double_fine = model.fit(train_dataset,\n","                         epochs=total_epochs,\n","                         initial_epoch=history_fine.epoch[-1],\n","                         validation_data=validation_dataset,\n","                    class_weight = classweight_dict)\n"],"metadata":{"id":"0-5DD0h1_3n9","executionInfo":{"status":"aborted","timestamp":1700838432434,"user_tz":0,"elapsed":6,"user":{"displayName":"Max C","userId":"15129973457982956339"}}},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["y_pred = []  # store predicted labels\n","y_true = []  # store true labels\n","\n","# iterate over the dataset\n","for image_batch, label_batch in test_dataset:   # use dataset.unbatch() with repeat\n","   # append true labels\n","   y_true.append(label_batch)\n","   # compute predictions\n","   preds = model.predict(image_batch)\n","   # append predicted labels\n","   y_pred.append(np.argmax(preds, axis = - 1))\n","\n","# # convert the true and predicted labels into tensors\n","correct_labels = tf.concat([np.argmax(item, axis=1) for item in y_true], axis = 0)\n","predicted_labels = tf.concat([item for item in y_pred], axis = 0)\n","\n","\n","ConfusionMatrixDisplay.from_predictions(correct_labels, predicted_labels, normalize='true', cmap = 'inferno')\n","plt.grid(False)\n","plt.show()\n","\n","model.save('DoubleFineTuneWeightedClassMobileNet.keras')"],"metadata":{"id":"PPUXJBG2AJXH","executionInfo":{"status":"aborted","timestamp":1700838432434,"user_tz":0,"elapsed":6,"user":{"displayName":"Max C","userId":"15129973457982956339"}}},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["base_model.trainable = True\n","# Fine-tune from this layer onwards\n","fine_tune_at = 80\n","\n","# Freeze all the layers before the `fine_tune_at` layer\n","for layer in base_model.layers[:fine_tune_at]:\n","  layer.trainable = False\n","\n","\n","optimizer = Adam(learning_rate= base_learning_rate/15)\n","\n","# Compile the model\n","\n","model.compile(optimizer = optimizer , loss = \"categorical_crossentropy\", metrics=[\"accuracy\"])\n","\n","\n","triple_fine_tune_epochs = 5\n","total_epochs =  initial_epochs + fine_tune_epochs + double_fine_tune_epochs + triple_fine_tune_epochs\n","\n","history_tiple_fine = model.fit(train_dataset,\n","                         epochs=total_epochs,\n","                         initial_epoch=history_double_fine.epoch[-1],\n","                         validation_data=validation_dataset,\n","                    class_weight = classweight_dict)\n","\n","\n","y_pred = []  # store predicted labels\n","y_true = []  # store true labels\n","\n","# iterate over the dataset\n","for image_batch, label_batch in test_dataset:   # use dataset.unbatch() with repeat\n","   # append true labels\n","   y_true.append(label_batch)\n","   # compute predictions\n","   preds = model.predict(image_batch)\n","   # append predicted labels\n","   y_pred.append(np.argmax(preds, axis = - 1))\n","\n","# # convert the true and predicted labels into tensors\n","correct_labels = tf.concat([np.argmax(item, axis=1) for item in y_true], axis = 0)\n","predicted_labels = tf.concat([item for item in y_pred], axis = 0)\n","\n","\n","ConfusionMatrixDisplay.from_predictions(correct_labels, predicted_labels, normalize='true', cmap = 'inferno')\n","plt.grid(False)\n","plt.show()\n","\n","model.save('TripleFineTuneWeightedClassMobileNet.keras')"],"metadata":{"id":"hTt7RIa5D8k5","executionInfo":{"status":"aborted","timestamp":1700838432434,"user_tz":0,"elapsed":77422,"user":{"displayName":"Max C","userId":"15129973457982956339"}}},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["acc += history_double_fine.history['accuracy']\n","val_acc += history_double_fine.history['val_accuracy']\n","\n","acc += history_tiple_fine.history['accuracy']\n","val_acc += history_tiple_fine.history['val_accuracy']\n","\n","plt.figure(figsize=(8, 8))\n","plt.subplot(2, 1, 1)\n","plt.plot(acc, label='Training Accuracy')\n","plt.plot(val_acc, label='Validation Accuracy')\n","plt.plot([initial_epochs-1,initial_epochs-1],\n","          plt.ylim(), label='Start Fine Tuning')\n","plt.plot([initial_epochs+fine_tune_epochs-1,initial_epochs+fine_tune_epochs-1],\n","          plt.ylim(), label='Start Fine Tuning 2')\n","plt.plot([initial_epochs+ fine_tune_epochs + double_fine_tune_epochs-1,initial_epochs+ fine_tune_epochs + double_fine_tune_epochs-1],\n","          plt.ylim(), label='Start Fine Tuning 3')\n","plt.legend(loc='lower right')\n","plt.xlim([0,20])\n","plt.title('Training and Validation Accuracy')"],"metadata":{"id":"-H5zfWJ6GiSS","executionInfo":{"status":"aborted","timestamp":1700838432434,"user_tz":0,"elapsed":77414,"user":{"displayName":"Max C","userId":"15129973457982956339"}}},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["ConfusionMatrixDisplay.from_predictions(correct_labels, predicted_labels,display_labels=list(code_to_name.values()), cmap='inferno', normalize='true', values_format=\".0%\")\n","plt.xticks(rotation=90)\n","plt.grid(False)\n","plt.show()"],"metadata":{"id":"0mEp0XqLIiOi","executionInfo":{"status":"aborted","timestamp":1700838432434,"user_tz":0,"elapsed":77408,"user":{"displayName":"Max C","userId":"15129973457982956339"}}},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["model.save('MobileNet.h5')"],"metadata":{"id":"jD5_13VxNVqW","executionInfo":{"status":"aborted","timestamp":1700838432434,"user_tz":0,"elapsed":77406,"user":{"displayName":"Max C","userId":"15129973457982956339"}}},"execution_count":null,"outputs":[]}],"metadata":{"colab":{"provenance":[{"file_id":"1d3I3hDm0ioQZE6ZNVA6m6MOUPwdo-K8_","timestamp":1700560877259},{"file_id":"1AjO2LQWmF4aajIcuBp6GphxS56Iz0Ly1","timestamp":1699886706275}],"mount_file_id":"1qSmSiAMVpK7seIBYK0vJB0VLnQz1mNZB","authorship_tag":"ABX9TyNqRebqcAhfmVCE5WrMRmms"},"kernelspec":{"display_name":"Python 3","name":"python3"},"language_info":{"name":"python"}},"nbformat":4,"nbformat_minor":0}